<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>–†–ê–ó–£–ú ‚Äî –ª–æ–≥–æ–ø–µ–¥–∏—á–µ—Å–∫–∏–π —Ü–µ–Ω—Ç—Ä</title>

<style>
body {
  font-family: Arial, sans-serif;
  background: linear-gradient(180deg,#eef2ff,#ffffff);
  margin: 0;
  padding: 16px;
}
header { text-align:center; margin-bottom:16px; }
.logo { max-width:140px; margin:0 auto 8px; display:block; }
.role-btn {
  width:100%; padding:12px; margin:6px 0;
  border:none; border-radius:14px;
  font-size:16px; background:#6366f1; color:#fff;
}
.card {
  background:#fff; border-radius:16px;
  padding:16px; margin-bottom:12px;
  box-shadow:0 4px 12px rgba(0,0,0,0.08);
}
.progress { background:#e5e7eb; border-radius:10px; overflow:hidden; }
.progress div { background:#22c55e; height:10px; }
.hidden { display:none; }
textarea, input, select {
  width:100%; padding:8px; margin-top:6px;
  border-radius:8px; border:1px solid #ccc;
}
</style>
</head>

<body>

<header>
  <img src="logo.png.jpg" class="logo" alt="–†–ê–ó–£–ú –ª–æ–≥–æ—Ç–∏–ø">
  <h1>–†–ê–ó–£–ú</h1>
  <p>–õ–æ–≥–æ–ø–µ–¥–∏—á–µ—Å–∫–∏–π —Ü–µ–Ω—Ç—Ä ‚Ä¢ –ü–µ—Ç–µ—Ä–≥–æ—Ñ</p>
  <p>üìû 8 913 450-30-29<br>üìç –°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥—Å–∫–∏–π –ø—Ä–æ—Å–ø–µ–∫—Ç 60–õ, 2 —ç—Ç–∞–∂</p>
</header>

<div id="roles">
  <button class="role-btn" onclick="showParent()">–Ø —Ä–æ–¥–∏—Ç–µ–ª—å</button>
  <button class="role-btn" onclick="showSpeech()">–Ø –ª–æ–≥–æ–ø–µ–¥</button>
  <button class="role-btn" onclick="showAdmin()">–Ø –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä</button>
</div>

<div id="parent" class="hidden"></div>
<div id="speech" class="hidden"></div>
<div id="admin" class="hidden"></div>

<script>
const data = JSON.parse(localStorage.getItem("razumData")) || {
  currentChildId: 1,
  currentTherapistId: 1,
  admin: { name: "–í–∞—Å—é–∫–æ–≤ –Æ—Ä–∏–π –°–µ—Ä–≥–µ–µ–≤–∏—á" },
  speechTherapists: [
    { id: 1, name: "–í–∞—Å—é–∫–æ–≤–∞ –ê–Ω–∞—Å—Ç–∞—Å–∏—è –ê–ª–µ–∫—Å–∞–Ω–¥—Ä–æ–≤–Ω–∞" },
    { id: 2, name: "–ü—Ä–æ–∫–æ–ø–µ–Ω–∫–æ –°–≤–µ—Ç–ª–∞–Ω–∞ –ì–µ–Ω–Ω–∞–¥—å–µ–≤–Ω–∞" },
    { id: 3, name: "–°–∞—Ñ—Ä–æ–Ω–æ–≤–∞ –ù–∞—Ç–∞–ª—å—è –ù–∏–∫–æ–ª–∞–µ–≤–Ω–∞" }
  ],
  children: [
    { id: 1, name: "–§—ë–¥–æ—Ä", age: 4, therapistId: 1, tasks: [{ id: 101, text: "–ü—Ä–æ–∏–∑–Ω–µ—Å—Ç–∏ 10 —Å–ª–æ–≤ —Å–æ –∑–≤—É–∫–æ–º –†", done: false }, { id: 102, text: "–°–ª–æ–≥–∏ –†–ê-–†–û-–†–£", done: false }], comment: "" },
    { id: 2, name: "–ê–ª–µ–∫—Å–∞–Ω–¥—Ä", age: 5, therapistId: 1, tasks: [], comment: "" },
    { id: 3, name: "–ê—Ä—Ç—ë–º", age: 6, therapistId: 1, tasks: [], comment: "" },
    { id: 4, name: "–ú–∏—Ä–æ—Å–ª–∞–≤–∞", age: 5, therapistId: 1, tasks: [], comment: "" },
    { id: 5, name: "–Ø—Å—è", age: 5, therapistId: 1, tasks: [], comment: "" },
    { id: 6, name: "–í–ª–∞–¥–∏–º–∏—Ä", age: 7, therapistId: 1, tasks: [], comment: "" },
    { id: 7, name: "–ú–∞—Ä–≥–∞—Ä–∏—Ç–∞", age: 4, therapistId: 1, tasks: [], comment: "" },
    { id: 8, name: "–ê–ª–µ–∫—Å–µ–π", age: 6, therapistId: 1, tasks: [], comment: "" },
    { id: 9, name: "–ö–æ–Ω—Å—Ç–∞–Ω—Ç–∏–Ω", age: 5, therapistId: 1, tasks: [], comment: "" },
    { id: 10, name: "–ü—ë—Ç—Ä", age: 6, therapistId: 1, tasks: [], comment: "" },
    { id: 11, name: "–ï–ª–∏–∑–∞–≤–µ—Ç–∞", age: 5, therapistId: 1, tasks: [], comment: "" },
    { id: 12, name: "–ê–ª—ë–Ω–∞", age: 4, therapistId: 1, tasks: [], comment: "" },
    { id: 13, name: "–ú–∏—è", age: 5, therapistId: 1, tasks: [], comment: "" },
    { id: 14, name: "–¢–∞–∏—Ä", age: 6, therapistId: 1, tasks: [], comment: "" },
    { id: 15, name: "–°—Ç–µ—à–∞", age: 5, therapistId: 1, tasks: [], comment: "" },
    { id: 16, name: "–õ–µ–æ–Ω–∏–¥", age: 7, therapistId: 1, tasks: [], comment: "" },
    { id: 17, name: "–°–∞–≤–µ–ª–∏–π", age: 6, therapistId: 1, tasks: [], comment: "" },
    { id: 18, name: "–ê—Ä–∏–Ω–∞", age: 5, therapistId: 1, tasks: [], comment: "" },
    { id: 19, name: "–ï–≤–≥–µ–Ω–∏–π", age: 6, therapistId: 1, tasks: [], comment: "" },
    { id: 20, name: "–í–∞–¥–∏–º", age: 7, therapistId: 1, tasks: [], comment: "" },
    { id: 21, name: "–Æ–ª–∏—è", age: 5, therapistId: 1, tasks: [], comment: "" },
    { id: 22, name: "–ö–∏—Ä–∏–ª–ª", age: 6, therapistId: 1, tasks: [], comment: "" },
    { id: 23, name: "–ó–æ—è", age: 7, therapistId: 1, tasks: [], comment: "" },
    { id: 24, name: "–ú–∏—Ö–∞–∏–ª", age: 5, therapistId: 1, tasks: [], comment: "" },

    { id: 25, name: "–î–∞–≤–∏–¥", age: 5, therapistId: 2, tasks: [], comment: "" },
    { id: 26, name: "–ú–∞–∫—Å–∏–º", age: 6, therapistId: 2, tasks: [], comment: "" },
    { id: 27, name: "–ú–∞–∫—Å–∏–º", age: 5, therapistId: 2, tasks: [], comment: "" },
    { id: 28, name: "–ú–∞–∫—Å–∏–º", age: 7, therapistId: 2, tasks: [], comment: "" },
    { id: 29, name: "–¢–∞—Ç—å—è–Ω–∞", age: 6, therapistId: 2, tasks: [], comment: "" },
    { id: 30, name: "–ò–ª—å—è", age: 5, therapistId: 2, tasks: [], comment: "" },
    { id: 31, name: "–ì–ª–µ–±", age: 6, therapistId: 2, tasks: [], comment: "" },
    { id: 32, name: "–§—ë–¥–æ—Ä", age: 4, therapistId: 2, tasks: [], comment: "" },

    { id: 33, name: "–ú–∞–π—è", age: 5, therapistId: 3, tasks: [], comment: "" }
  ]
};

function save() {
  localStorage.setItem("razumData", JSON.stringify(data));
}

function getCurrentTherapist() {
  return data.speechTherapists.find(t => t.id === data.currentTherapistId);
}

function getCurrentChild() {
  return data.children.find(c => c.id === data.currentChildId);
}

function hideAll() {
  ["roles", "parent", "speech", "admin"].forEach(id => {
    document.getElementById(id).classList.add("hidden");
  });
}

function back() {
  hideAll();
  document.getElementById("roles").classList.remove("hidden");
}

function childSelector() {
  // –í—ã–±–∏—Ä–∞–µ–º –¥–µ—Ç–µ–π —É —Ç–µ–∫—É—â–µ–≥–æ –ª–æ–≥–æ–ø–µ–¥–∞
  const children = data.children.filter(c => c.therapistId === data.currentTherapistId);
  if (children.length === 0) return `<p>–ù–µ—Ç –¥–µ—Ç–µ–π –¥–ª—è –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ –ª–æ–≥–æ–ø–µ–¥–∞.</p>`;

  return `
    <select onchange="changeChild(this.value)">
      ${children.map(c =>
        `<option value="${c.id}" ${c.id === data.currentChildId ? "selected" : ""}>
          ${c.name} (${c.age})
        </option>`).join("")}
    </select>
  `;
}

function therapistSelector() {
  return `
    <select onchange="changeTherapist(this.value)">
      ${data.speechTherapists.map(t =>
        `<option value="${t.id}" ${t.id === data.currentTherapistId ? "selected" : ""}>
          ${t.name}
        </option>`).join("")}
    </select>
  `;
}

function changeChild(id) {
  data.currentChildId = Number(id);
  save();
  showSpeech();
}

function changeTherapist(id) {
  data.currentTherapistId = Number(id);
  // –ü–æ—Å–ª–µ —Å–º–µ–Ω—ã –ª–æ–≥–æ–ø–µ–¥–∞ –ø–µ—Ä–µ–∫–ª—é—á–∞–µ–º—Å—è –Ω–∞ –ø–µ—Ä–≤–æ–≥–æ —Ä–µ–±–µ–Ω–∫–∞ —ç—Ç–æ–≥–æ –ª–æ–≥–æ–ø–µ–¥–∞ (–µ—Å–ª–∏ –µ—Å—Ç—å)
  const children = data.children.filter(c => c.therapistId === data.currentTherapistId);
  data.currentChildId = children.length > 0 ? children[0].id : null;
  save();
  showSpeech();
}

/* –†–û–î–ò–¢–ï–õ–¨ */
function showParent() {
  hideAll();
  const c = getCurrentChild();
  const p = document.getElementById("parent");

  if (!c) {
    p.innerHTML = `<p>–í—ã–±–µ—Ä–∏—Ç–µ —Ä–µ–±—ë–Ω–∫–∞ –≤ –º–µ–Ω—é —Ä–æ–¥–∏—Ç–µ–ª—è.</p><button class="role-btn" onclick="back()">–ù–∞–∑–∞–¥</button>`;
    p.classList.remove("hidden");
    return;
  }

  p.innerHTML = `
    ${childSelector()}
    <h2>${c.name} (${c.age} –≥–æ–¥–∞)</h2>
    <p><b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –ª–æ–≥–æ–ø–µ–¥–∞:</b><br>${c.comment || "‚Äî"}</p>
    <div class="progress"><div style="width:${progress(c)}%"></div></div>
    <h3>–ó–∞–¥–∞–Ω–∏—è</h3>
  `;

  c.tasks.forEach(t => {
    p.innerHTML += `
      <div class="card">
        <label>
          <input type="checkbox" ${t.done ? "checked" : ""}
            onchange="toggle(${t.id})">
          ${t.text}
        </label>
      </div>`;
  });

  p.innerHTML += `<button class="role-btn" onclick="back()">–ù–∞–∑–∞–¥</button>`;
  p.classList.remove("hidden");
}

function toggle(id) {
  const c = getCurrentChild();
  if (!c) return;
  const t = c.tasks.find(x => x.id === id);
  if (t) t.done = !t.done;
  save();
  showParent();
}

function progress(c) {
  if (!c.tasks.length) return 0;
  return c.tasks.filter(t => t.done).length / c.tasks.length * 100;
}

/* –õ–û–ì–û–ü–ï–î */
function showSpeech() {
  hideAll();

  const s = document.getElementById("speech");
  const therapist = getCurrentTherapist();

  if (!therapist) {
    s.innerHTML = `<p>–í—ã–±–µ—Ä–∏—Ç–µ –ª–æ–≥–æ–ø–µ–¥–∞.</p><button class="role-btn" onclick="back()">–ù–∞–∑–∞–¥</button>`;
    s.classList.remove("hidden");
    return;
  }

  const c = getCurrentChild();

  s.innerHTML = `
    ${therapistSelector()}
    ${childSelector()}
    <h2>–õ–æ–≥–æ–ø–µ–¥: ${therapist.name}</h2>
    <div class="card">
      <b>${c ? c.name : "–ù–µ—Ç –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ —Ä–µ–±—ë–Ω–∫–∞"}</b><br>
      <textarea placeholder="–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–æ–¥–∏—Ç–µ–ª—é" oninput="updateComment(this.value)">${c ? c.comment : ""}</textarea>

      <h4>–ù–æ–≤–æ–µ –∑–∞–¥–∞–Ω–∏–µ</h4>
      <input id="taskText" placeholder="–í–≤–µ–¥–∏—Ç–µ –∑–∞–¥–∞–Ω–∏–µ">
      <button class="role-btn" onclick="addTask()">–î–æ–±–∞–≤–∏—Ç—å</button>
    </div>
    <button class="role-btn" onclick="back()">–ù–∞–∑–∞–¥</button>
  `;
  s.classList.remove("hidden");
}

function updateComment(value) {
  const c = getCurrentChild();
  if (!c) return;
  c.comment = value;
  save();
}

function addTask() {
  const text = document.getElementById("taskText").value.trim();
  if (!text) return;
  const c = getCurrentChild();
  if (!c) return;
  c.tasks.push({ id: Date.now(), text, done: false });
  save();
  showSpeech();
}

/* –ê–î–ú–ò–ù */
function showAdmin() {
  hideAll();
  const a = document.getElementById("admin");
  a.innerHTML = `
    <h2>–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä</h2>
    <div class="card">üë∂ –î–µ—Ç–µ–π: ${data.children.length}</div>
    <div class="card">üë©‚Äç‚öïÔ∏è –õ–æ–≥–æ–ø–µ–¥–æ–≤: ${data.speechTherapists.length}</div>
    <div class="card">–¶–µ–Ω—Ç—Ä —Ä–∞–±–æ—Ç–∞–µ—Ç —Å—Ç–∞–±–∏–ª—å–Ω–æ ‚úÖ</div>
    <button class="role-btn" onclick="back()">–ù–∞–∑–∞–¥</button>
  `;
  a.classList.remove("hidden");
}

save();
</script>

</body>
</html>
