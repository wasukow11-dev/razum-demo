<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>–†–ê–ó–£–ú ‚Äî –¥–µ–º–æ –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã</title>

<style>
body {
  margin:0;
  font-family:Arial, sans-serif;
  background:linear-gradient(180deg,#eef2ff,#ffffff);
  padding:16px;
}
.header{text-align:center;margin-bottom:16px}
.logo{font-size:34px;font-weight:bold;color:#4f46e5}
.sub{font-size:14px;color:#555}
.contacts{font-size:13px;margin-top:6px}

button{
  width:100%;
  padding:14px;
  border:none;
  border-radius:16px;
  background:#6366f1;
  color:#fff;
  font-size:16px;
  margin:6px 0;
}

.card{
  background:#fff;
  border-radius:18px;
  padding:16px;
  margin-bottom:12px;
  box-shadow:0 8px 20px rgba(0,0,0,.08);
}

textarea{
  width:100%;
  min-height:80px;
  border-radius:12px;
  border:1px solid #ccc;
  padding:10px;
  font-size:14px;
}

.progress{background:#e5e7eb;border-radius:12px;overflow:hidden}
.progress div{height:12px;background:linear-gradient(90deg,#22c55e,#16a34a)}

.badge{
  display:inline-block;
  background:#fde68a;
  padding:4px 10px;
  border-radius:12px;
  font-size:12px;
  margin-top:6px;
}

.hidden{display:none}
.small{font-size:13px;color:#555}
</style>
</head>

<body>

<div class="header">
  <div class="logo">–†–ê–ó–£–ú</div>
  <div class="sub">–õ–æ–≥–æ–ø–µ–¥–∏—á–µ—Å–∫–∏–π —Ü–µ–Ω—Ç—Ä ‚Ä¢ –ü–µ—Ç–µ—Ä–≥–æ—Ñ</div>
  <div class="contacts">
    üìç –°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥—Å–∫–∏–π –ø—Ä–æ—Å–ø–µ–∫—Ç 60–õ, 2 —ç—Ç–∞–∂<br>
    üìû 8 913 450-30-09
  </div>
</div>

<div id="roles">
  <button onclick="parentView()">–Ø —Ä–æ–¥–∏—Ç–µ–ª—å</button>
  <button onclick="speechView()">–Ø –ª–æ–≥–æ–ø–µ–¥</button>
  <button onclick="adminView()">–Ø –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä</button>
</div>

<section id="screen"></section>

<script>
/* ===== –î–ê–ù–ù–´–ï ===== */

const logopedists = {
  "–í–∞—Å—é–∫–æ–≤–∞ –ê–Ω–∞—Å—Ç–∞—Å–∏—è –ê–ª–µ–∫—Å–∞–Ω–¥—Ä–æ–≤–Ω–∞": [
    "–§—ë–¥–æ—Ä","–ê–ª–µ–∫—Å–∞–Ω–¥—Ä","–ê—Ä—Ç—ë–º","–ú–∏—Ä–æ—Å–ª–∞–≤–∞","–Ø—Å—è","–í–ª–∞–¥–∏–º–∏—Ä","–ú–∞—Ä–≥–∞—Ä–∏—Ç–∞",
    "–ê–ª–µ–∫—Å–µ–π","–ö–æ–Ω—Å—Ç–∞–Ω—Ç–∏–Ω","–ü—ë—Ç—Ä","–ï–ª–∏–∑–∞–≤–µ—Ç–∞","–ê–ª—ë–Ω–∞","–ú–∏—è","–¢–∞–∏—Ä","–°—Ç–µ—à–∞",
    "–õ–µ–æ–Ω–∏–¥","–°–∞–≤–µ–ª–∏–π","–ê—Ä–∏–Ω–∞","–ï–≤–≥–µ–Ω–∏–π","–í–∞–¥–∏–º","–Æ–ª–∏—è","–ö–∏—Ä–∏–ª–ª","–ó–æ—è","–ú–∏—Ö–∞–∏–ª"
  ],
  "–ü—Ä–æ–∫–æ–ø–µ–Ω–∫–æ –°–≤–µ—Ç–ª–∞–Ω–∞ –ì–µ–Ω–Ω–∞–¥—å–µ–≤–Ω–∞": [
    "–î–∞–≤–∏–¥","–ú–∞–∫—Å–∏–º","–ú–∞–∫—Å–∏–º","–ú–∞–∫—Å–∏–º","–¢–∞—Ç—å—è–Ω–∞","–ò–ª—å—è","–ì–ª–µ–±","–§—ë–¥–æ—Ä"
  ],
  "–°–∞—Ñ—Ä–æ–Ω–æ–≤–∞ –ù–∞—Ç–∞–ª—å—è –ù–∏–∫–æ–ª–∞–µ–≤–Ω–∞": ["–ú–∞–π—è"]
};

let children = JSON.parse(localStorage.getItem("razum_children")) || [];
if(children.length === 0){
  let id=1;
  Object.entries(logopedists).forEach(([speech,kids])=>{
    kids.forEach(name=>{
      children.push({
        id:id++,
        name,
        age:3+id%4,
        speech,
        stars:2+id%4,
        level:1+id%3,
        lessonsLeft:8-id%5,
        comment:"–ü–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–∞—è –¥–∏–Ω–∞–º–∏–∫–∞, —Ä–µ–±—ë–Ω–æ–∫ —Å—Ç–∞—Ä–∞–µ—Ç—Å—è üëç",
        visits:0,
        misses:0
      });
    });
  });
  save();
}

function save(){
  localStorage.setItem("razum_children", JSON.stringify(children));
}

/* ===== –£–¢–ò–õ–ò–¢–´ ===== */

const screen=document.getElementById("screen");
function clear(){screen.innerHTML="";document.getElementById("roles").classList.add("hidden")}
function back(){screen.innerHTML="";document.getElementById("roles").classList.remove("hidden")}

/* ===== –†–û–î–ò–¢–ï–õ–¨ ===== */

function parentView(){
  clear();
  screen.innerHTML="<h2>–õ–æ–≥–æ–ø–µ–¥—ã</h2>";
  Object.keys(logopedists).forEach(l=>{
    screen.innerHTML+=`<div class="card" onclick="parentChildren('${l}')"><b>${l}</b></div>`;
  });
  screen.innerHTML+=`<button onclick="back()">–ù–∞–∑–∞–¥</button>`;
}

function parentChildren(speech){
  clear();
  screen.innerHTML=`<h2>${speech}</h2>`;
  children.filter(c=>c.speech===speech).forEach(c=>{
    screen.innerHTML+=`
      <div class="card" onclick="childCard(${c.id}, false)">
        <b>${c.name}</b> (${c.age} –ª–µ—Ç)
      </div>`;
  });
  screen.innerHTML+=`<button onclick="parentView()">–ù–∞–∑–∞–¥</button>`;
}

function childCard(id,isSpeech){
  clear();
  const c=children.find(x=>x.id===id);
  screen.innerHTML=`
    <h2>${c.name}</h2>
    <div class="card">
      –õ–æ–≥–æ–ø–µ–¥: ${c.speech}<br><br>
      ‚≠ê ${c.stars} | üèÜ ${c.level}
      <div class="progress"><div style="width:${c.stars*20}%"></div></div><br>
      üéü –û—Å—Ç–∞–ª–æ—Å—å –∑–∞–Ω—è—Ç–∏–π: <b>${c.lessonsLeft}</b><br><br>
      üí¨ –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –ª–æ–≥–æ–ø–µ–¥–∞:<br>
      <i>${c.comment}</i>
    </div>
    <button onclick="${isSpeech?'speechView()':'parentView()'}">–ù–∞–∑–∞–¥</button>`;
}

/* ===== –õ–û–ì–û–ü–ï–î ===== */

function speechView(){
  clear();
  Object.keys(logopedists).forEach(l=>{
    screen.innerHTML+=`<div class="card" onclick="speechChildren('${l}')"><b>${l}</b></div>`;
  });
  screen.innerHTML+=`<button onclick="back()">–ù–∞–∑–∞–¥</button>`;
}

function speechChildren(speech){
  clear();
  screen.innerHTML=`<h2>${speech}</h2>`;
  children.filter(c=>c.speech===speech).forEach(c=>{
    screen.innerHTML+=`
      <div class="card" onclick="speechChild(${c.id})">
        <b>${c.name}</b><br>
        –û—Å—Ç–∞–ª–æ—Å—å –∑–∞–Ω—è—Ç–∏–π: ${c.lessonsLeft}
      </div>`;
  });
  screen.innerHTML+=`<button onclick="speechView()">–ù–∞–∑–∞–¥</button>`;
}

function speechChild(id){
  clear();
  const c=children.find(x=>x.id===id);
  screen.innerHTML=`
    <h2>${c.name}</h2>
    <div class="card">
      –û—Å—Ç–∞–ª–æ—Å—å –∑–∞–Ω—è—Ç–∏–π: ${c.lessonsLeft}<br><br>

      üí¨ –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –ª–æ–≥–æ–ø–µ–¥–∞:
      <textarea id="comment">${c.comment}</textarea><br>
      <button onclick="saveComment(${c.id})">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π</button><br><br>

      <button onclick="visit(${c.id})">‚úÖ –ü—Ä–∏—à—ë–ª</button>
      <button onclick="miss(${c.id})">‚ùå –ü—Ä–æ–ø—É—Å—Ç–∏–ª</button>
    </div>
    <button onclick="speechView()">–ù–∞–∑–∞–¥</button>`;
}

function saveComment(id){
  const c=children.find(x=>x.id===id);
  c.comment=document.getElementById("comment").value;
  save();
  alert("–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Å–æ—Ö—Ä–∞–Ω—ë–Ω");
}

function visit(id){
  const c=children.find(x=>x.id===id);
  c.visits++; if(c.lessonsLeft>0)c.lessonsLeft--;
  save(); speechView();
}
function miss(id){
  const c=children.find(x=>x.id===id);
  c.misses++; save(); speechView();
}

/* ===== –ê–î–ú–ò–ù ===== */

function adminView(){
  clear();
  let visits=children.reduce((a,c)=>a+c.visits,0);
  let misses=children.reduce((a,c)=>a+c.misses,0);
  screen.innerHTML=`
    <h2>–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä</h2>
    <div class="card">üë∂ –î–µ—Ç–µ–π: ${children.length}</div>
    <div class="card">üìä –Ø–≤–∫–∏: ${visits}<br>–ü—Ä–æ–ø—É—Å–∫–∏: ${misses}</div>
    <button onclick="back()">–ù–∞–∑–∞–¥</button>`;
}
</script>

</body>
</html>
