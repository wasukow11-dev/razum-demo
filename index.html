<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>–†–ê–ó–£–ú ‚Äî –ª–æ–≥–æ–ø–µ–¥–∏—á–µ—Å–∫–∏–π —Ü–µ–Ω—Ç—Ä</title>
<style>
body { font-family: Arial, sans-serif; background: linear-gradient(180deg, #fff8e6, #e0f7fa); margin:0; padding:16px; }
header { text-align:center; margin-bottom:16px; }
.logo { max-width:120px; margin:0 auto 8px; display:block; }
.role-btn { width:100%; padding:12px; margin:6px 0; border:none; border-radius:12px; font-size:16px; color:#fff; cursor:pointer; }
.role-btn:hover { opacity:0.9; }
.card { background:#fff; border-radius:12px; padding:16px; margin-bottom:12px; box-shadow:0 4px 10px rgba(0,0,0,0.1); }
.child-avatar { width:48px; height:48px; border-radius:50%; margin-right:12px; }
.child-header { display:flex; align-items:center; }
.progress { background:#e5e7eb; border-radius:10px; overflow:hidden; height:12px; margin:8px 0; }
.progress div { background:#22c55e; height:12px; transition:0.3s; }
.hidden { display:none; }
textarea,input,select { width:100%; padding:8px; margin-top:6px; border-radius:8px; border:1px solid #ccc; }
</style>
</head>
<body>

<header>
  <img src="logo.png" class="logo" alt="–õ–æ–≥–æ—Ç–∏–ø">
  <h1>–†–ê–ó–£–ú</h1>
  <p>–õ–æ–≥–æ–ø–µ–¥–∏—á–µ—Å–∫–∏–π —Ü–µ–Ω—Ç—Ä ‚Ä¢ –ü–µ—Ç–µ—Ä–≥–æ—Ñ</p>
  <p>üìû 8 913 450‚Äë30‚Äë29<br>üìç –°–∞–Ω–∫—Ç‚Äë–ü–µ—Ç–µ—Ä–±—É—Ä–≥—Å–∫–∏–π –ø—Ä., 60–õ</p>
</header>

<div id="roles">
  <button id="btnParent" class="role-btn" style="background:#4a90e2">–Ø —Ä–æ–¥–∏—Ç–µ–ª—å</button>
  <button id="btnSpeech" class="role-btn" style="background:#22c55e">–Ø –ª–æ–≥–æ–ø–µ–¥</button>
  <button id="btnAdmin" class="role-btn" style="background:#f59e0b">–Ø –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä</button>
</div>

<div id="parent" class="hidden"></div>
<div id="speech" class="hidden"></div>
<div id="admin" class="hidden"></div>

<script>
// ======== –î–ê–ù–ù–´–ï (–¥–µ–º–æ) ========
const demo = {
  children: [
    {id:1,name:"–§—ë–¥–æ—Ä",age:4,avatar:"https://i.pravatar.cc/50?img=1",tasks:[{id:1,text:"–ü—Ä–æ–∏–∑–Ω–µ—Å—Ç–∏ 10 —Å–ª–æ–≤ —Å–æ –∑–≤—É–∫–æ–º –†",done:false},{id:2,text:"–°–ª–æ–≥–∏ –†–ê‚Äë–†–û‚Äë–†–£",done:false}],comment:"",paid:8,attended:0},
    {id:2,name:"–ê–ª–µ–∫—Å–∞–Ω–¥—Ä",age:5,avatar:"https://i.pravatar.cc/50?img=2",tasks:[],comment:"",paid:12,attended:3},
    {id:3,name:"–ê—Ä—Ç—ë–º",age:6,avatar:"https://i.pravatar.cc/50?img=3",tasks:[],comment:"",paid:4,attended:1},
    {id:4,name:"–ú–∏—Ä–æ—Å–ª–∞–≤–∞",age:4,avatar:"https://i.pravatar.cc/50?img=4",tasks:[],comment:"",paid:8,attended:2},
    {id:5,name:"–Ø—Å—è",age:5,avatar:"https://i.pravatar.cc/50?img=5",tasks:[],comment:"",paid:12,attended:5}
  ],
  teachers: [
    {id:1,name:"–í–∞—Å—é–∫–æ–≤–∞ –ê–Ω–∞—Å—Ç–∞—Å–∏—è –ê–ª–µ–∫—Å–∞–Ω–¥—Ä–æ–≤–Ω–∞",children:[1,2,3]},
    {id:2,name:"–ü—Ä–æ–∫–æ–ø–µ–Ω–∫–æ –°–≤–µ—Ç–ª–∞–Ω–∞ –ì–µ–Ω–Ω–∞–¥—å–µ–≤–Ω–∞",children:[2,4]},
    {id:3,name:"–°–∞—Ñ—Ä–æ–Ω–æ–≤–∞ –ù–∞—Ç–∞–ª—å—è –ù–∏–∫–æ–ª–∞–µ–≤–Ω–∞",children:[5]}
  ]
};

// –ì–ª–æ–±–∞–ª—å–Ω—ã–π –æ–±—ä–µ–∫—Ç –¥–ª—è state
let data = JSON.parse(localStorage.getItem("razumData")) || demo;

// –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ
function save(){ localStorage.setItem("razumData", JSON.stringify(data)); }

// –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç DOM –∏ —Å–∫—Ä—ã–≤–∞–µ—Ç –æ—Å—Ç–∞–ª—å–Ω—ã–µ
function hideAll(){["roles","parent","speech","admin"].forEach(id=>document.getElementById(id).classList.add("hidden"));}
function showSection(id){ hideAll(); document.getElementById(id).classList.remove("hidden"); }

// ====== –†–û–î–ò–¢–ï–õ–¨ ======
function showParent(){
  showSection("parent");
  const parentDiv = document.getElementById("parent");
  parentDiv.innerHTML = "";

  data.children.forEach(c => {
    const card = document.createElement("div");
    card.className = "card";

    const header = document.createElement("div");
    header.className = "child-header";
    const avatar = document.createElement("img");
    avatar.className = "child-avatar";
    avatar.src = c.avatar;
    const name = document.createElement("h2");
    name.innerText = `${c.name} (${c.age})`;
    header.appendChild(avatar);
    header.appendChild(name);
    card.appendChild(header);

    const comment = document.createElement("p");
    comment.innerHTML = `<b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π:</b> ${c.comment||"‚Äî"}`;
    card.appendChild(comment);

    const prog = document.createElement("div");
    prog.className = "progress";
    const progInner = document.createElement("div");
    progInner.style.width = c.tasks.length ? `${c.tasks.filter(t=>t.done).length/c.tasks.length*100}%` : "0%";
    prog.appendChild(progInner);
    card.appendChild(prog);

    const tasksTitle = document.createElement("h3");
    tasksTitle.innerText = "–ó–∞–¥–∞–Ω–∏—è";
    card.appendChild(tasksTitle);

    c.tasks.forEach(t => {
      const tDiv = document.createElement("div");
      tDiv.innerText = `${t.done?"‚úÖ":"‚ùå"} ${t.text}`;
      card.appendChild(tDiv);
    });

    const attendance = document.createElement("p");
    attendance.innerHTML = `<b>–û–ø–ª–∞—á–µ–Ω–æ:</b> ${c.paid} ‚Ä¢ <b>–ü–æ—Å–µ—â–µ–Ω–æ:</b> ${c.attended} ‚Ä¢ <b>–û—Å—Ç–∞—Ç–æ–∫:</b> ${c.paid - c.attended}`;
    card.appendChild(attendance);

    parentDiv.appendChild(card);
  });

  const backBtn = document.createElement("button");
  backBtn.className="role-btn";
  backBtn.style.background="#4a90e2";
  backBtn.innerText="–ù–∞–∑–∞–¥";
  backBtn.onclick = ()=>showSection("roles");
  parentDiv.appendChild(backBtn);
}

// ====== –õ–û–ì–û–ü–ï–î ======
function showSpeech(){
  showSection("speech");
  const speechDiv = document.getElementById("speech");
  speechDiv.innerHTML = "";

  const sel = document.createElement("select");
  data.teachers.forEach(t=>{
    const opt = document.createElement("option");
    opt.value = t.id;
    opt.text = t.name;
    sel.appendChild(opt);
  });
  sel.onchange = () => renderTeacherChildren(sel.value);
  speechDiv.appendChild(sel);

  function renderTeacherChildren(teacherId){
    speechDiv.querySelectorAll(".child-card").forEach(e=>e.remove());

    const teacher = data.teachers.find(t=>t.id == teacherId);
    if(!teacher) return;

    teacher.children.forEach(cid=>{
      const c = data.children.find(ch=>ch.id===cid);
      if(!c) return;

      const card = document.createElement("div");
      card.className = "card child-card";

      const header = document.createElement("div");
      header.className = "child-header";
      const avatar = document.createElement("img");
      avatar.src = c.avatar;
      avatar.className = "child-avatar";
      const name = document.createElement("h2");
      name.innerText = `${c.name} (${c.age})`;
      header.appendChild(avatar);
      header.appendChild(name);
      card.appendChild(header);

      const commentLabel = document.createElement("p");
      commentLabel.innerHTML = `<b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π:</b>`;
      card.appendChild(commentLabel);

      const ta = document.createElement("textarea");
      ta.value = c.comment;
      ta.onchange = ()=>{ c.comment = ta.value; save(); };
      card.appendChild(ta);

      const taskInput = document.createElement("input");
      taskInput.placeholder = "–ù–æ–≤–æ–µ –∑–∞–¥–∞–Ω–∏–µ";
      card.appendChild(taskInput);

      const addBtn = document.createElement("button");
      addBtn.className="role-btn";
      addBtn.style.background="#22c55e";
      addBtn.innerText = "–î–æ–±–∞–≤–∏—Ç—å –∑–∞–¥–∞–Ω–∏–µ";
      addBtn.onclick = ()=>{
        if(taskInput.value.trim()){ c.tasks.push({id:Date.now(),text:taskInput.value,done:false}); save(); renderTeacherChildren(teacherId); }
      };
      card.appendChild(addBtn);

      const attendanceBtn = document.createElement("button");
      attendanceBtn.className="role-btn";
      attendanceBtn.style.background="#22c55e";
      attendanceBtn.innerText = "–û—Ç–º–µ—Ç–∏—Ç—å –ø–æ—Å–µ—â–µ–Ω–∏–µ";
      attendanceBtn.onclick = ()=>{
        if(c.attended < c.paid){ c.attended++; save(); renderTeacherChildren(teacherId); }
      };
      card.appendChild(attendanceBtn);

      const att = document.createElement("p");
      att.innerHTML = `<b>–û–ø–ª–∞—á–µ–Ω–æ:</b> ${c.paid} ‚Ä¢ <b>–ü–æ—Å–µ—â–µ–Ω–æ:</b> ${c.attended} ‚Ä¢ <b>–û—Å—Ç–∞—Ç–æ–∫:</b> ${c.paid-c.attended}`;
      card.appendChild(att);

      const tasksTitle = document.createElement("h3");
      tasksTitle.innerText="–ó–∞–¥–∞–Ω–∏—è";
      card.appendChild(tasksTitle);

      c.tasks.forEach(t=>{
        const tLine = document.createElement("div");
        const chk = document.createElement("input");
        chk.type = "checkbox";
        chk.checked = t.done;
        chk.onchange = ()=>{ t.done = chk.checked; save(); renderTeacherChildren(teacherId); };
        tLine.appendChild(chk);
        tLine.appendChild(document.createTextNode(" "+t.text));
        card.appendChild(tLine);
      });

      speechDiv.appendChild(card);
    });

    const backBtn=document.createElement("button");
    backBtn.className="role-btn";
    backBtn.style.background="#22c55e";
    backBtn.innerText="–ù–∞–∑–∞–¥";
    backBtn.onclick = ()=>showSection("roles");
    speechDiv.appendChild(backBtn);
  }

  if(data.teachers.length) sel.value=data.teachers[0].id, sel.onchange();
}

// ====== –ê–î–ú–ò–ù ======
function showAdmin(){
  showSection("admin");
  const adminDiv = document.getElementById("admin");
  adminDiv.innerHTML = "";

  data.children.forEach(c => {
    const card = document.createElement("div");
    card.className="card";

    const header = document.createElement("div");
    header.className="child-header";
    const avatar = document.createElement("img");
    avatar.src = c.avatar;
    avatar.className="child-avatar";
    const h3 = document.createElement("h3");
    h3.innerText = `${c.name} (${c.age})`;
    header.appendChild(avatar);
    header.appendChild(h3);
    card.appendChild(header);

    const comment = document.createElement("p");
    comment.innerHTML = `<b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π:</b> ${c.comment||"‚Äî"}`;
    card.appendChild(comment);

    const tasksTitle = document.createElement("h4");
    tasksTitle.innerText = "–ó–∞–¥–∞–Ω–∏—è";
    card.appendChild(tasksTitle);

    c.tasks.forEach(t=>{
      const div = document.createElement("div");
      div.innerText = `${t.done?"‚úÖ":"‚ùå"} ${t.text}`;
      card.appendChild(div);
    });

    const att = document.createElement("p");
    att.innerHTML = `<b>–û–ø–ª–∞—á–µ–Ω–æ:</b> ${c.paid} ‚Ä¢ <b>–ü–æ—Å–µ—â–µ–Ω–æ:</b> ${c.attended} ‚Ä¢ <b>–û—Å—Ç–∞—Ç–æ–∫:</b> ${c.paid-c.attended}`;
    card.appendChild(att);

    adminDiv.appendChild(card);
  });

  const summary=document.createElement("div");
  summary.className="card";
  summary.innerHTML=`üë©‚Äç‚öïÔ∏è –õ–æ–≥–æ–ø–µ–¥–æ–≤: ${data.teachers.length}<br>–î–µ—Ç–µ–π: ${data.children.length}`;
  adminDiv.appendChild(summary);

  const backBtn=document.createElement("button");
  backBtn.className="role-btn";
  backBtn.style.background="#f59e0b";
  backBtn.innerText="–ù–∞–∑–∞–¥";
  backBtn.onclick = ()=>showSection("roles");
  adminDiv.appendChild(backBtn);
}

// Event listeners
document.getElementById("btnParent").onclick = showParent;
document.getElementById("btnSpeech").onclick = showSpeech;
document.getElementById("btnAdmin").onclick = showAdmin;

</script>
</body>
</html>
